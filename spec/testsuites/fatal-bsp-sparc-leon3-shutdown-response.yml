SPDX-License-Identifier: CC-BY-SA-4.0 OR BSD-2-Clause
copyrights:
- Copyright (C) 2021 embedded brains GmbH (http://www.embedded-brains.de)
enabled-by:
  and:
  - RTEMS_SMP
  - bsps/sparc/leon3
links:
- role: requirement-refinement
  uid: /req/test-suites
test-brief: |
  This validation test suite contains a test case which performs a system
  shutdown.
test-code: |
  const char rtems_test_name[] = "${.:/test-suite-name}";

  #define FATAL_SYSINIT_RUN BspSparcLeon3ValFatalShutdownResponse_Run

  static void FatalSysinitExit( rtems_fatal_code exit_code )
  {
    if ( exit_code == 0 ) {
      rtems_fatal( RTEMS_FATAL_SOURCE_SMP, SMP_FATAL_SHUTDOWN );
    } else {
      rtems_fatal( RTEMS_FATAL_SOURCE_EXIT, exit_code );
    }
  }

  #define FATAL_SYSINIT_EXIT( exit_code ) FatalSysinitExit( exit_code )

  #define CONFIGURE_APPLICATION_DOES_NOT_NEED_CLOCK_DRIVER

  #define CONFIGURE_MAXIMUM_PROCESSORS 2

  #include "ts-fatal-sysinit.h"
test-description: null
test-includes:
- rtems/score/smpimpl.h
test-local-includes:
- tr-fatal-bsp-sparc-leon3-shutdown-response.h
test-suite-name: FatalBspSparcLeon3ShutdownResponse
test-target: testsuites/validation/ts-fatal-bsp-sparc-leon3-shutdown-response.c
type: test-suite
