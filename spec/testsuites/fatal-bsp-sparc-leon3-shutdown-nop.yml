SPDX-License-Identifier: CC-BY-SA-4.0 OR BSD-2-Clause
copyrights:
- Copyright (C) 2021 embedded brains GmbH (http://www.embedded-brains.de)
enabled-by:
  and:
  - RTEMS_SMP
  - bsps/sparc/leon3
links:
- role: requirement-refinement
  uid: /req/test-suites
- role: validation
  uid: /bsp/sparc/leon3/req/fatal-shutdown-request
test-brief: |
  This validation test suite provides an application configuration to perform a
  shutdown with present but not configured processors and a processor which is
  configured but not present.  It contains no test cases.
test-code: |
  const char rtems_test_name[] = "${.:/test-suite-name}";

  static void FinishTestSuite( void )
  {
    rtems_fatal( RTEMS_FATAL_SOURCE_APPLICATION, 123456 );
  }

  RTEMS_SYSINIT_ITEM(
    FinishTestSuite,
    RTEMS_SYSINIT_DEVICE_DRIVERS,
    RTEMS_SYSINIT_ORDER_MIDDLE
  );

  #define FATAL_SYSINIT_RUN( source, code ) do { } while ( 0 )

  #define CONFIGURE_APPLICATION_DOES_NOT_NEED_CLOCK_DRIVER

  #define CONFIGURE_MAXIMUM_PROCESSORS 5

  #include <rtems/score/scheduleredfsmp.h>

  #define CONFIGURE_SCHEDULER_EDF_SMP

  #include <rtems/scheduler.h>

  RTEMS_SCHEDULER_EDF_SMP( a );

  #define CONFIGURE_SCHEDULER_TABLE_ENTRIES \
    RTEMS_SCHEDULER_TABLE_EDF_SMP( a, TEST_SCHEDULER_A_NAME )

  #define CONFIGURE_SCHEDULER_ASSIGNMENTS \
    RTEMS_SCHEDULER_ASSIGN( 0, RTEMS_SCHEDULER_ASSIGN_PROCESSOR_MANDATORY ), \
    RTEMS_SCHEDULER_ASSIGN_NO_SCHEDULER, \
    RTEMS_SCHEDULER_ASSIGN_NO_SCHEDULER, \
    RTEMS_SCHEDULER_ASSIGN_NO_SCHEDULER, \
    RTEMS_SCHEDULER_ASSIGN( 0, RTEMS_SCHEDULER_ASSIGN_PROCESSOR_OPTIONAL )

  #include "ts-fatal-sysinit.h"
test-description: null
test-includes:
- rtems.h
- rtems/sysinit.h
test-local-includes:
- ts-config.h
test-suite-name: FatalBspSparcLeon3ShutdownNop
test-target: testsuites/validation/ts-fatal-bsp-sparc-leon3-shutdown-nop.c
type: test-suite
